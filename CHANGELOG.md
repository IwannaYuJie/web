# å˜æ›´æ—¥å¿— (Changelog)

æœ¬æ–‡æ¡£è®°å½•é¡¹ç›®çš„æ‰€æœ‰é‡è¦å˜æ›´å’Œç‰ˆæœ¬æ›´æ–°ã€‚

---

## [2025-11-17] - ğŸ¨ é¦–é¡µå…¨é¢UIä¼˜åŒ–

### âœ¨ è§†è§‰è®¾è®¡å‡çº§

#### 1. å…¨å±€å­—ä½“ä¸é…è‰²
- **ç°ä»£å­—ä½“æ ˆ**ï¼šåœ¨ `src/index.css` ä¸­å¼•å…¥ `Noto Sans SC` å’Œ `PingFang SC` ä½œä¸ºä¼˜å…ˆå­—ä½“ï¼Œæå‡ä¸­æ–‡é˜…è¯»ä½“éªŒ
- **å­—å·å±‚çº§è§„èŒƒ**ï¼šæ–°å¢ CSS å˜é‡å®šä¹‰æ ‡å‡†å­—å·ä½“ç³»
  - åŸºå‡†å­—å· 15pxï¼Œå¤§æ­£æ–‡ 16pxï¼Œå°å­— 13px
  - æ ‡é¢˜å±‚çº§ï¼šH1(28px) â†’ H2(24px) â†’ H3(20px) â†’ H4(18px)
- **é“¾æ¥å¢å¼ºè¯†åˆ«**ï¼šç»Ÿä¸€æ–‡æœ¬é“¾æ¥æ·»åŠ ä¸‹åˆ’çº¿ä¸æ‚¬åœé«˜äº®æ•ˆæœï¼Œæå‡å¯æ“ä½œæ€§è¾¨è¯†åº¦

#### 2. é¡¶éƒ¨å¯¼èˆªæ å¢å¼º
- **æ‚¬æµ®æ•ˆæœ**ï¼šå¯¼èˆªæ æ·»åŠ æ»šåŠ¨ç›‘å¬ï¼Œæ»šåŠ¨åè‡ªåŠ¨ç´§ç¼©å¹¶å¢å¼ºé˜´å½±
- **Logo äº¤äº’**ï¼šLogo æ‚¬åœæ—¶äº§ç”Ÿç¼©æ”¾+æ—‹è½¬åŠ¨ç”»ï¼Œå¢å¼ºå“ç‰Œè¶£å‘³æ€§
- **èœå•é¡¹ä¼˜åŒ–**ï¼š
  - å¢åŠ èœå•é¡¹é—´è·è‡³ 1remï¼Œé¿å…æ‹¥æŒ¤æ„Ÿ
  - æ‚¬åœæ—¶æ·»åŠ å…‰æ™•æ‰©æ•£æ•ˆæœä¸ 3D æå‡åŠ¨ç”»
  - æŒ‰é’®èƒŒæ™¯ä»åŠé€æ˜æå‡è‡³ 12%ï¼Œæ¿€æ´»æ€è¾¾ 28%

#### 3. å¡ç‰‡ç³»ç»Ÿå…¨é¢æ”¹ç‰ˆ
- **æ–‡ç« å¡ç‰‡**ï¼š
  - åœ†è§’ä» 16px æå‡è‡³ 24pxï¼Œè¥é€ æ›´æŸ”å’Œè§†è§‰
  - æ‚¬åœæ—¶å¡ç‰‡æå‡ 8px å¹¶æ”¾å¤§ 1.02 å€ï¼Œé…åˆåŠ¨æ€é˜´å½±å˜åŒ–
  - é¡¶éƒ¨æ¸å˜è‰²æ¡ä»å·¦å‘å³å±•å¼€ä½œä¸ºæ¿€æ´»æŒ‡ç¤ºå™¨
  - æ©˜çŒ«çˆªå°è£…é¥°åœ¨æ‚¬åœæ—¶æ”¾å¤§æ—‹è½¬ï¼Œå¢å¼ºè¶£å‘³æ€§
- **åˆ†ç±»æ ‡ç­¾**ï¼š
  - ç§»è‡³å¡ç‰‡å³ä¸Šè§’ï¼Œé‡‡ç”¨èƒ¶å›Šå½¢çŠ¶è®¾è®¡
  - æ‚¬åœæ—¶æ ‡ç­¾æœ¬èº«ä¹Ÿä¼šç¼©æ”¾æå‡ï¼Œä¸å¡ç‰‡å½¢æˆè”åŠ¨
- **å¿«é€Ÿå¯¼èˆªå¡ç‰‡**ï¼š
  - Icon æ‚¬åœæ—¶æ”¾å¤§ 1.2 å€å¹¶æ—‹è½¬ 10 åº¦
  - å¡ç‰‡æå‡é«˜åº¦å¢è‡³ 10pxï¼Œé…åˆå¾®ç¼©æ”¾æ•ˆæœ

#### 4. åˆ†ç±»æ ‡ç­¾èƒ¶å›Šè®¾è®¡
- **å½¢çŠ¶ä¼˜åŒ–**ï¼šæ‰€æœ‰åˆ†ç±»æ ‡ç­¾ç»Ÿä¸€é‡‡ç”¨åœ†è§’èƒ¶å›Šå½¢çŠ¶ï¼ˆborder-radius: 9999pxï¼‰
- **äº¤äº’åé¦ˆ**ï¼š
  - æ‚¬åœæ—¶æ ‡ç­¾å‘ä¸Šæµ®åŠ¨ 3px å¹¶æ”¾å¤§ 1.05 å€
  - æ·»åŠ å†…éƒ¨å…‰æ•ˆæ‰«è¿‡åŠ¨ç”»ï¼Œä»å·¦è‡³å³æ»‘åŠ¨é«˜å…‰
  - æ¿€æ´»æ ‡ç­¾ä½¿ç”¨æ©˜çŒ«æ¸å˜å¡«å……ï¼Œå¹¶è‡ªåŠ¨æå‡æ˜¾ç¤º
- **è§¦æ§å‹å¥½**ï¼šæœ€å°é«˜åº¦è®¾ç½®ä¸º 44pxï¼Œç¬¦åˆç§»åŠ¨ç«¯è§¦æ§è§„èŒƒ

#### 5. æŒ‰é’®ç³»ç»Ÿç»Ÿä¸€è®¾è®¡
- **ä¸»è¦æŒ‰é’®**ï¼ˆ.btn-primaryï¼‰ï¼š
  - æ©˜çŒ«æ¸å˜èƒŒæ™¯ + åœ†è§’èƒ¶å›Šå½¢çŠ¶
  - æ‚¬åœæ—¶å†…éƒ¨çˆ†å‘åœ†å½¢å…‰æ•ˆï¼ˆ300px ç›´å¾„ï¼‰
  - æå‡ 4px å¹¶æ”¾å¤§ 1.05 å€ï¼Œé˜´å½±å¼ºåŒ–è‡³ 0.4 é€æ˜åº¦
- **æ¬¡è¦æŒ‰é’®**ï¼ˆ.btn-secondaryï¼‰ï¼š
  - ç™½è‰²èƒŒæ™¯ + æ©˜è‰²è¾¹æ¡†ï¼Œæ‚¬åœæ—¶èƒŒæ™¯å˜æš–è‰²è°ƒ
  - ä¸€è‡´çš„æå‡åŠ¨ç”»ä¸é˜´å½±å˜åŒ–
- **æ“ä½œæŒ‰é’®**ï¼ˆç¼–è¾‘/åˆ é™¤ï¼‰ï¼š
  - ç¼–è¾‘æŒ‰é’®é‡‡ç”¨æ©˜è‰²ç³»ï¼Œåˆ é™¤æŒ‰é’®é‡‡ç”¨çº¢è‰²ç³»
  - æ‚¬åœæ—¶æŒ‰é’®åŒæ ·æå‡ 2px å¹¶æ”¾å¤§ 1.1 å€
  - æœ€å°å°ºå¯¸ 40x40pxï¼Œç¡®ä¿è§¦æ§å‡†ç¡®æ€§

#### 6. é¡µè„šä¸è¿”å›é¡¶éƒ¨
- **é¡µè„šè£…é¥°**ï¼š
  - æ¸å˜èƒŒæ™¯ä»ç±³ç™½åˆ°æ©˜é»„è¿‡æ¸¡
  - å·¦å³å„æ·»åŠ å¤§å·åŠé€æ˜æ©˜çŒ«çˆªå°è£…é¥°
  - é¡¶éƒ¨æ©˜è‰²è¾¹æ¡†åŠ ç²—è‡³ 3px
- **è¿”å›é¡¶éƒ¨æŒ‰é’®**ï¼š
  - å›ºå®šåœ¨å³ä¸‹è§’çš„åœ†å½¢æ‚¬æµ®æŒ‰é’®ï¼ˆ56x56pxï¼‰
  - æ»šåŠ¨è¶…è¿‡ 400px æ—¶å¹³æ»‘æ·¡å…¥æ˜¾ç¤º
  - æ‚¬åœæ—¶æå‡ 5px å¹¶æ”¾å¤§ 1.1 å€ï¼Œç‚¹å‡»å³å¹³æ»‘æ»šåŠ¨è‡³é¡¶éƒ¨

#### 7. ç§»åŠ¨ç«¯å“åº”å¼ä¼˜åŒ–
- **æ±‰å ¡èœå•**ï¼š
  - 768px ä»¥ä¸‹å±å¹•æ˜¾ç¤ºæ±‰å ¡å›¾æ ‡æŒ‰é’®
  - ç‚¹å‡»åä»å³ä¾§æ»‘å‡ºå…¨å±æŠ½å±‰å¼èœå•ï¼ˆ75% å®½åº¦ï¼Œæœ€å¤§ 300pxï¼‰
  - èœå•é¡¹å‚ç›´æ’åˆ—ï¼Œæ¯é¡¹é«˜åº¦ä¸ä½äº 48px
  - èœå•æ‰“å¼€æ—¶èƒŒæ™¯æ·»åŠ åŠé€æ˜é®ç½©å±‚
- **æŒ‰é’®å°ºå¯¸**ï¼š
  - æ‰€æœ‰äº¤äº’å…ƒç´ æœ€å°å°ºå¯¸ç»Ÿä¸€ä¸º 48x48pxï¼ˆiOS è§¦æ§æ ‡å‡†ï¼‰
  - å¡ç‰‡ã€æ ‡ç­¾ã€æŒ‰é’®å‡ç¡®ä¿è¶³å¤Ÿè§¦æ§é¢ç§¯
- **é˜²æ­¢æ¨ªå‘æ»šåŠ¨**ï¼š
  - å¯¼èˆªèœå•æ”¹ä¸ºå‚ç›´å †å 
  - ç½‘æ ¼å¸ƒå±€åœ¨ç§»åŠ¨ç«¯è‡ªåŠ¨åˆ‡æ¢ä¸ºå•åˆ—

#### 8. åŠ¨æ•ˆä¸å¾®äº¤äº’
- **é¡µé¢åŠ è½½åŠ¨ç”»**ï¼š
  - é¡µé¢æ ‡é¢˜ä»ä¸Šæ–¹æ·¡å…¥ä¸‹æ»‘ï¼ˆfadeInDownï¼‰
  - å„åŒºå—ä»ä¸‹æ–¹æ»‘å…¥ï¼ˆslideInUpï¼‰
  - æ–‡ç« å¡ç‰‡ä¾æ¬¡å‡ºç°ï¼Œæ¯å¼ å»¶è¿Ÿ 0.05 ç§’å½¢æˆæ³¢æµªæ•ˆæœ
  - åˆ†ç±»æ ‡ç­¾ä»¥ç¼©æ”¾æ·¡å…¥æ–¹å¼ä¾æ¬¡æ˜¾ç¤º
- **å¿«é€Ÿå¯¼èˆªåŠ¨ç”»**ï¼š
  - å››å¼ å¡ç‰‡ä¾æ¬¡ä»ä¸‹æ–¹æ»‘å…¥ï¼Œå»¶è¿Ÿé€’å¢ 0.1 ç§’
  - Icon æ‚¬åœæ—‹è½¬ + æ”¾å¤§ç»„åˆåŠ¨ç”»
- **è¿‡æ¸¡ä¼˜åŒ–**ï¼š
  - æ‰€æœ‰åŠ¨ç”»é‡‡ç”¨ cubic-bezier(0.4, 0, 0.2, 1) ç¼“åŠ¨å‡½æ•°
  - é¢œè‰²ã€é˜´å½±ã€å˜æ¢ç»Ÿä¸€è¿‡æ¸¡æ—¶é—´ 0.3-0.4 ç§’

### ğŸ“‚ æ–‡ä»¶å˜æ›´æ¸…å•

#### ä¿®æ”¹æ–‡ä»¶
- `src/index.css`ï¼šå…¨å±€å­—ä½“ã€å­—å·å˜é‡ã€é“¾æ¥ä¸æŒ‰é’®åŸºç¡€æ ·å¼
- `src/App.css`ï¼šå¯¼èˆªæ ã€å¡ç‰‡ã€æ ‡ç­¾ã€æŒ‰é’®ã€é¡µè„šã€åŠ¨ç”»ç­‰æ ¸å¿ƒæ ·å¼
- `src/App.jsx`ï¼šå¯¼èˆªæ æ»šåŠ¨ç›‘å¬ã€ç§»åŠ¨ç«¯èœå•çŠ¶æ€ç®¡ç†
- `src/pages/Home.jsx`ï¼šè¿”å›é¡¶éƒ¨æŒ‰é’®åŠŸèƒ½å®ç°
- `CHANGELOG.md`ï¼šæœ¬æ¬¡ä¼˜åŒ–å®Œæ•´è®°å½•

### ğŸ¯ ä¼˜åŒ–æ•ˆæœ

âœ… **è§†è§‰å±‚æ¬¡æ›´æ¸…æ™°**ï¼šå­—å·ä½“ç³»è§„èŒƒï¼Œæ ‡é¢˜ä¸æ­£æ–‡å¯¹æ¯”æ˜æ˜¾  
âœ… **äº¤äº’åé¦ˆæ›´ä¸°å¯Œ**ï¼šæ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ å‡æœ‰æ˜ç¡®çš„æ‚¬åœ/ç‚¹å‡»åŠ¨ç”»  
âœ… **ç§»åŠ¨ä½“éªŒæå‡**ï¼šæŠ½å±‰å¼èœå•ã€è§¦æ§å‹å¥½æŒ‰é’®ã€æ— æ¨ªå‘æ»šåŠ¨  
âœ… **åŠ è½½ä½“éªŒä¼˜åŒ–**ï¼šé¡µé¢å…ƒç´ ä¾æ¬¡æ·¡å…¥ï¼Œå‡å°‘çªå…€æ„Ÿ  
âœ… **å“ç‰Œä¸€è‡´æ€§**ï¼šæ©˜çŒ«ä¸»é¢˜è‰²è´¯ç©¿æ‰€æœ‰ç»„ä»¶ï¼Œç»Ÿä¸€åœ†è§’èƒ¶å›Šè®¾è®¡

---

## [2025-11-17] - ğŸ–¼ï¸ Seedream v4 å›¾åƒç¼–è¾‘èƒ½åŠ›

### âœ¨ æ–°åŠŸèƒ½

- åœ¨ `src/pages/SeedreamStudio.jsx` ä¸­åŠ å…¥æ¨¡å¼åˆ‡æ¢ï¼Œæ”¯æŒåˆ‡æ¢åˆ°æ”¹å›¾æ¨¡å¼å¹¶è°ƒç”¨ `fal-ai/bytedance/seedream/v4/edit`
- åœ¨æ”¹å›¾æ¨¡å¼ä¸‹æ–°å¢æœ¬åœ°ä¸Šä¼ ä¸ URL ç²˜è´´ä¸¤ç§å…¥å›¾æ–¹å¼ã€æ§åˆ¶å¼ºåº¦æ»‘å—ï¼Œä»¥åŠå®æ—¶é¢„è§ˆä¸ç§»é™¤å…¥å£

### ğŸ’… æ ·å¼æ›´æ–°

- `src/pages/SeedreamStudio.css` æ–°å¢æ¨¡å¼åˆ‡æ¢ã€ä¸Šä¼ é¢„è§ˆã€æ ‡ç­¾æŒ‰é’®ç­‰æ©˜çŒ«ä¸»é¢˜æ ·å¼ï¼Œä¿æŒä¸ç°æœ‰é¢æ¿è§†è§‰ä¸€è‡´

### ğŸ§ª è¡Œä¸ºä¼˜åŒ–

- åœ¨ `SeedreamStudio.jsx` ä¸­ç»Ÿä¸€å¤„ç† Fal.ai è¿”å›ç»“æ„ï¼Œæ²¿ç”¨æ–‡ç”Ÿå›¾è§£æé€»è¾‘ä»¥å…¼å®¹ `result.data.images`
- å¼•å…¥ Fal.ai å­˜å‚¨ä¸Šä¼ æµç¨‹ï¼Œç¡®ä¿æœ¬åœ°æ–‡ä»¶å¯å®‰å…¨ä¼ é€’è‡³æ”¹å›¾ API

---

## [2025-11-17] - ğŸ¨ æ–°å¢ Seedream v4 éšè—å®éªŒå®¤

### âœ¨ æ–°åŠŸèƒ½

- åœ¨ `src/pages/SeedreamStudio.jsx` ä¸­æ–°å¢ Fal.ai Seedream v4 æ–‡ç”Ÿå›¾å®éªŒå®¤é¡µé¢ï¼Œæ”¯æŒå°ºå¯¸é¢„è®¾ã€è‡ªå®šä¹‰å°ºå¯¸ã€å¢å¼ºæ¨¡å¼ã€åŒæ­¥æ¨¡å¼ä»¥åŠå®‰å…¨æ£€æŸ¥ç­‰å‚æ•°è°ƒèŠ‚
- ç»“æœé¢æ¿æ”¯æŒæŸ¥çœ‹ç”Ÿæˆç§å­ã€æ‰¹é‡å±•ç¤ºå›¾ç‰‡å¹¶æä¾›ä¸‹è½½å…¥å£ï¼Œå…¼å®¹ URL ä¸ Base64 ä¸¤ç§è¿”å›æ ¼å¼

### ğŸ” ç”¨æˆ·ä½“éªŒ

- æä¾›æœ¬åœ° API Key ç®¡ç†ï¼šé¡µé¢å…è®¸è¾“å…¥ã€ä¿å­˜ä¸æ¸…é™¤ FAL_KEYï¼Œä¿¡æ¯ä»…å­˜å‚¨åœ¨æµè§ˆå™¨ `localStorage`
- åœ¨ `src/App.jsx` æ³¨å†Œéšè—è·¯ç”± `/secret-seedream`ï¼Œä»…é€šè¿‡æ‰‹åŠ¨è®¿é—®å¯ç”¨é«˜çº§é¢æ¿

### ğŸ“¦ ä¾èµ–è°ƒæ•´

- åœ¨ `package.json` ä¸­æ–°å¢ `@fal-ai/client` ä¾èµ–ä»¥è°ƒç”¨ Fal.ai SDK

### ğŸ“š æ–‡æ¡£åŒæ­¥

- åœ¨ `README.md` çš„ AI å›¾ç‰‡ç”Ÿæˆç« èŠ‚è¡¥å……éšè—å®éªŒå®¤å…¥å£ä¸ä½¿ç”¨è¯´æ˜

---

## [2025-11-15] - ğŸ”’ Worker åå‘ä»£ç†å®‰å…¨åŠ å›º

### ğŸ›¡ï¸ å®‰å…¨å¢å¼ºï¼ˆSecurity Enhancementï¼‰

#### é—®é¢˜èƒŒæ™¯
å¯¹ç°æœ‰çš„ Cloudflare Worker åå‘ä»£ç†è¿›è¡Œå®‰å…¨å®¡è®¡ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š
1. **Source Map æ³„éœ²** - Vite ç”Ÿäº§æ„å»ºé»˜è®¤ç”Ÿæˆ `.map` æ–‡ä»¶ï¼Œå¯èƒ½æš´éœ²æºä»£ç 
2. **å“åº”å¤´ä¿¡æ¯æ³„éœ²** - ä»…æ¸…ç†äº† 4 ä¸ªå“åº”å¤´ï¼Œå­˜åœ¨æœåŠ¡å™¨æŒ‡çº¹è¯†åˆ«é£é™©
3. **é”™è¯¯å¤„ç†ç¼ºå¤±** - åŸç«™é”™è¯¯ä¿¡æ¯å¯èƒ½ç›´æ¥ä¼ é€’ç»™ç”¨æˆ·
4. **ç¼ºå°‘å®‰å…¨ç­–ç•¥å¤´** - æ—  CSPã€Referrer Policy ç­‰ç°ä»£å®‰å…¨å¤´éƒ¨

#### å½±å“è¯„ä¼°
- ğŸ”´ **Source Map**: é«˜é£é™©ï¼Œæ”»å‡»è€…å¯æŸ¥çœ‹å®Œæ•´æºç ã€æ–‡ä»¶è·¯å¾„ã€æ³¨é‡Š
- ğŸŸ¡ **å“åº”å¤´æ³„éœ²**: ä¸­é£é™©ï¼Œå¯é€šè¿‡æœåŠ¡å™¨æŒ‡çº¹æ¨æµ‹åŸç«™æ¶æ„
- ğŸŸ¡ **é”™è¯¯ä¿¡æ¯**: ä¸­é£é™©ï¼Œå¯èƒ½æš´éœ²åŸç«™åŸŸåæˆ–é…ç½®ä¿¡æ¯
- ğŸŸ¢ **ç¼ºå°‘å®‰å…¨å¤´**: ä½é£é™©ï¼Œä½†è¿åå®‰å…¨æœ€ä½³å®è·µ

### âœ… å®æ–½çš„åŠ å›ºæªæ–½

#### 1. ç¦ç”¨ Source Mapï¼ˆ`vite.config.js`ï¼‰
```javascript
build: {
  sourcemap: false,          // ğŸ”’ ç¦ç”¨ Source Map
  minify: 'esbuild',         // ä½¿ç”¨ esbuildï¼ˆVite å†…ç½®ï¼Œé€Ÿåº¦æ›´å¿«ï¼‰
  esbuildOptions: {
    drop: ['console', 'debugger'], // ç§»é™¤ console.log å’Œ debugger
    legalComments: 'none',         // ç§»é™¤æ‰€æœ‰æ³¨é‡Š
  },
}
```
**é˜²æŠ¤æ•ˆæœ**: ç”Ÿäº§ç¯å¢ƒä¸å†ç”Ÿæˆ `.map` æ–‡ä»¶ï¼Œæ”»å‡»è€…æ— æ³•é€†å‘æºä»£ç 
**æ€§èƒ½ä¼˜åŒ–**: ä» Terser åˆ‡æ¢åˆ° esbuildï¼Œæ„å»ºé€Ÿåº¦æå‡çº¦ 10 å€

#### 2. å¢å¼ºå“åº”å¤´æ¸…ç†ï¼ˆ`workers/game-proxy.js`ï¼‰
æ–°å¢æ¸…ç†çš„å“åº”å¤´ï¼ˆä» 4 ä¸ªå¢åŠ åˆ° 13 ä¸ªï¼‰ï¼š
```javascript
const headersToRemove = [
  'x-powered-by', 'server', 'x-vercel-id', 'x-cloudflare-request-id',
  'x-amz-cf-id', 'x-amz-cf-pop', 'x-cache', 'via', 
  'x-served-by', 'x-timer', 'x-fastly-request-id', 
  'cf-ray', 'cf-cache-status'
];
```

æ–°å¢å®‰å…¨å“åº”å¤´ï¼š
```javascript
'x-content-type-options': 'nosniff'      // é˜²æ­¢ MIME å—…æ¢
'x-frame-options': 'DENY'                // é˜²æ­¢ç‚¹å‡»åŠ«æŒ
'referrer-policy': 'no-referrer'         // ğŸ”’ é˜²æ­¢ Referer æ³„éœ²
'content-security-policy': '...'         // å†…å®¹å®‰å…¨ç­–ç•¥
```

#### 3. æ·»åŠ ä¸¥æ ¼çš„ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰
```javascript
content-security-policy: 
  "default-src 'self'; " +
  "script-src 'self' 'unsafe-inline' 'unsafe-eval'; " +
  "connect-src 'self'; " +  // ğŸ”’ é™åˆ¶åªèƒ½è¿æ¥å½“å‰åŸŸå
  "object-src 'none'; " +
  "base-uri 'self'"
```
**é˜²æŠ¤æ•ˆæœ**: å³ä½¿æ”»å‡»è€…æ³¨å…¥è„šæœ¬ï¼Œä¹Ÿæ— æ³•è¿æ¥å¤–éƒ¨æœåŠ¡å™¨

#### 4. å®Œå–„é”™è¯¯å¤„ç†
```javascript
try {
  // ... ä»£ç†é€»è¾‘
} catch (error) {
  return new Response(JSON.stringify({ 
    error: 'Service temporarily unavailable'  // ğŸ”’ ä¸æš´éœ²å…·ä½“é”™è¯¯
  }), { status: 503 });
}
```
**é˜²æŠ¤æ•ˆæœ**: åŸç«™çš„ 500/404 é”™è¯¯ä¸ä¼šæ³„éœ²ç»™ç”¨æˆ·

### ğŸ“ æ–°å¢æ–‡æ¡£

- **WORKER_SECURITY_GUIDE.md** - Worker å®‰å…¨åŠ å›ºå®Œæ•´æŒ‡å—
  - âœ… å·²å®æ–½çš„å®‰å…¨æªæ–½è¯¦è§£
  - âš ï¸ ä»å­˜åœ¨çš„ç†è®ºé£é™©åˆ†æï¼ˆæ—¶åºæ”»å‡»ã€TLS æŒ‡çº¹ç­‰ï¼‰
  - ğŸ›¡ï¸ é¢å¤–å®‰å…¨å»ºè®®ï¼ˆé™é€Ÿã€ç›‘æ§ã€å†…å®¹æ‰«æï¼‰
  - ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•
  - ğŸ†˜ åº”æ€¥å“åº”æµç¨‹

### ğŸ“Š å®‰å…¨æµ‹è¯•å»ºè®®

éƒ¨ç½²åæ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š
```bash
# 1. ç¡®è®¤æ—  Source Map
ls dist/assets/*.map  # åº”è¯¥æ²¡æœ‰è¾“å‡º

# 2. æ£€æŸ¥å“åº”å¤´
curl -I https://your-worker-domain.com

# 3. åœ¨çº¿å®‰å…¨æ‰«æ
# è®¿é—® https://securityheaders.com è¾“å…¥åŸŸå
```

### ğŸ”„ åç»­ç»´æŠ¤è¦æ±‚

æ¯æ¬¡ä»£ç æ›´æ–°åå¿…é¡»ï¼š
1. ç¡®è®¤ `sourcemap: false` ä»ç„¶ç”Ÿæ•ˆ
2. æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„ç¡¬ç¼–ç åŸŸå
3. é‡æ–°æ„å»ºå¹¶éªŒè¯ `dist/` ä¸­æ—  `.map` æ–‡ä»¶

### âš ï¸ å·²çŸ¥é™åˆ¶

ä»¥ä¸‹é£é™©ç”±äºæŠ€æœ¯é™åˆ¶æ— æ³•å®Œå…¨æ¶ˆé™¤ï¼š
- **æ—¶åºæ”»å‡»**: é€šè¿‡å“åº”æ—¶é—´æ¨æµ‹æœåŠ¡å™¨ä½ç½®ï¼ˆé£é™©ç­‰çº§ï¼šä½ï¼‰
- **TLS æŒ‡çº¹**: SSL æ¡æ‰‹ç‰¹å¾åˆ†æï¼ˆå·²ä½¿ç”¨ Cloudflare è¯ä¹¦ç¼“è§£ï¼‰
- **ç¤¾ä¼šå·¥ç¨‹**: WHOIS/DNS æŸ¥è¯¢ï¼ˆéœ€ä½¿ç”¨éšç§ä¿æŠ¤ WHOISï¼‰

è¯¦è§ `WORKER_SECURITY_GUIDE.md` çš„"ä»å­˜åœ¨çš„ç†è®ºé£é™©"ç« èŠ‚ã€‚

---

## [2025-01-15] - ğŸ”’ é‡å¤§å®‰å…¨æ›´æ–°ï¼šç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç  API Key

### ğŸš¨ å®‰å…¨ä¿®å¤ï¼ˆCriticalï¼‰

#### é—®é¢˜æè¿°
åœ¨å…¨é¢å®‰å…¨å®¡è®¡ä¸­å‘ç°å¤šå¤„ç¡¬ç¼–ç çš„ API Keyï¼Œå­˜åœ¨ä¸¥é‡çš„å®‰å…¨éšæ‚£ï¼š
- ä¸ƒç‰›äº‘ AI API Key ç¡¬ç¼–ç åœ¨ 2 ä¸ªæ–‡ä»¶ä¸­
- ç«å±±å¼•æ“ API Key ç¡¬ç¼–ç åœ¨ 4 ä¸ªæ–‡ä»¶ä¸­
- å…¶ä¸­ 1 å¤„åœ¨å‰ç«¯ä»£ç ä¸­ï¼ˆæœ€å±é™©ï¼‰

#### å½±å“èŒƒå›´
å¦‚æœä»£ç ä»“åº“ä¸ºå…¬å¼€çŠ¶æ€ï¼Œä»»ä½•äººéƒ½èƒ½çœ‹åˆ°è¿™äº› API Keyï¼Œå¯èƒ½å¯¼è‡´ï¼š
- API é¢åº¦è¢«ç›—ç”¨
- äº§ç”Ÿæ„å¤–è´¹ç”¨
- æœåŠ¡è¢«æ»¥ç”¨

#### è§£å†³æ–¹æ¡ˆ
**å…¨é¢ç§»é™¤ç¡¬ç¼–ç ï¼Œé‡‡ç”¨ç¯å¢ƒå˜é‡æ–¹æ¡ˆ**ï¼š

1. **åç«¯ API å‡½æ•°**ï¼ˆCloudflare Functionsï¼‰
   - âœ… `functions/api/ai-chat.js` - ç§»é™¤ç¡¬ç¼–ç ï¼Œä»…ä» `context.env.QINIU_AI_API_KEY` è¯»å–
   - âœ… `functions/api/generate-image.js` - ç§»é™¤ç¡¬ç¼–ç ï¼Œä»…ä» `context.env.ARK_API_KEY` è¯»å–
   - âœ… `api/generate-image.js` - ç§»é™¤ç¡¬ç¼–ç ï¼Œä»…ä» `process.env.ARK_API_KEY` è¯»å–
   - âœ… æ·»åŠ ç¯å¢ƒå˜é‡æ£€æŸ¥ï¼Œç¼ºå°‘æ—¶è¿”å› 500 é”™è¯¯å’Œæç¤ºä¿¡æ¯

2. **å¼€å‘ç¯å¢ƒé…ç½®**ï¼ˆViteï¼‰
   - âœ… `vite.config.js` - ä» `process.env` è¯»å–ï¼Œæä¾›å ä½ç¬¦
   - âœ… æ”¯æŒé€šè¿‡ `.env` æ–‡ä»¶é…ç½®æœ¬åœ°å¼€å‘ API Key

3. **å‰ç«¯ä»£ç **
   - âœ… `src/pages/ImageGenerator.jsx` - ç§»é™¤ç¡¬ç¼–ç çš„ API Key
   - âœ… å‰ç«¯ä¸å†åŒ…å«ä»»ä½•æ•æ„Ÿä¿¡æ¯

### ğŸ“ é…ç½®å˜æ›´

#### æ–°å¢æ–‡ä»¶
- **SECURITY_CHECKLIST.md** - å®‰å…¨æ£€æŸ¥æ¸…å•å’Œæœ€ä½³å®è·µæ–‡æ¡£
  - åŒ…å«å¿«é€Ÿå®‰å…¨æ‰«æå‘½ä»¤
  - API Key æ³„éœ²ä¿®å¤æ­¥éª¤
  - å®šæœŸæ£€æŸ¥é¡¹ç›®æ¸…å•

#### ä¿®æ”¹æ–‡ä»¶
- **README.md** - æ·»åŠ ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
  - æœ¬åœ°å¼€å‘ `.env` é…ç½®æ­¥éª¤
  - Cloudflare Pages ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
  - å®‰å…¨æé†’å’Œæ³¨æ„äº‹é¡¹

- **.env.example** - å·²å­˜åœ¨ï¼Œæ— éœ€ä¿®æ”¹
  - æä¾›ç¯å¢ƒå˜é‡æ¨¡æ¿
  - ä¸åŒ…å«çœŸå® API Key

- **.gitignore** - å·²åŒ…å« `.env`ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰
  - ç¡®ä¿ç¯å¢ƒå˜é‡æ–‡ä»¶ä¸è¢«æäº¤

### ğŸ”§ ä½¿ç”¨æŒ‡å—

#### æœ¬åœ°å¼€å‘é…ç½®

1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š
   ```bash
   cp .env.example .env
   ```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥çœŸå® API Keyï¼š
   ```env
   ARK_API_KEY=ä½ çš„ç«å±±å¼•æ“APIå¯†é’¥
   QINIU_AI_API_KEY=ä½ çš„ä¸ƒç‰›äº‘AI APIå¯†é’¥
   ```

3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
   ```bash
   npm run dev
   ```

#### Cloudflare Pages ç”Ÿäº§ç¯å¢ƒé…ç½®

1. ç™»å½• Cloudflare Dashboard
2. è¿›å…¥é¡¹ç›® Settings â†’ Environment variables
3. æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
   - `ARK_API_KEY` = ç«å±±å¼•æ“ API å¯†é’¥
   - `QINIU_AI_API_KEY` = ä¸ƒç‰›äº‘ AI API å¯†é’¥
4. ä¿å­˜åé‡æ–°éƒ¨ç½²

### âœ… å®‰å…¨æ£€æŸ¥ç»“æœ

- âœ… æ‰€æœ‰ç¡¬ç¼–ç  API Key å·²ç§»é™¤
- âœ… å‰ç«¯ä»£ç ä¸åŒ…å«ä»»ä½•æ•æ„Ÿä¿¡æ¯
- âœ… åç«¯å¢åŠ ç¯å¢ƒå˜é‡æ ¡éªŒ
- âœ… `.env` æ–‡ä»¶å·²åœ¨ `.gitignore` ä¸­
- âœ… æœªå‘ç°ä¸ªäººä¿¡æ¯æ³„éœ²ï¼ˆpenghaoxiangã€958656603 ç­‰ï¼‰

### âš ï¸ é‡è¦æé†’

1. **ç«‹å³æ›´æ¢æ—§ API Key**ï¼ˆå¦‚æœä»“åº“æ›¾å…¬å¼€ï¼‰ï¼š
   - ç™»å½•ç«å±±å¼•æ“æ§åˆ¶å°ï¼Œé‡ç½® API Key
   - ç™»å½•ä¸ƒç‰›äº‘æ§åˆ¶å°ï¼Œé‡ç½® API Key
   - æ›´æ–° Cloudflare Pages ç¯å¢ƒå˜é‡

2. **Git å†å²æ¸…ç†**ï¼ˆå¦‚æœæ•æ„Ÿä¿¡æ¯å·²æäº¤ï¼‰ï¼š
   - å‚è€ƒ `SECURITY_CHECKLIST.md` ä¸­çš„æ¸…ç†æ­¥éª¤
   - ä½¿ç”¨ BFG Repo-Cleaner æˆ– git-filter-branch

3. **è®¾ç½®ä»“åº“ä¸ºç§æœ‰**ï¼ˆæ¨èï¼‰ï¼š
   - GitHub ä»“åº“è®¾ç½® â†’ Settings â†’ Danger Zone â†’ Change visibility

---

## [2025-11-12] - ä¿®å¤æ–‡ç« ç®¡ç† API 405 é”™è¯¯

### ğŸ› Bug ä¿®å¤

#### é—®é¢˜æè¿°
åœ¨è‡ªå®šä¹‰åŸŸå `jumaomaomaoju.cn` ä¸Šï¼Œæ–‡ç« çš„ç¼–è¾‘å’Œåˆ é™¤åŠŸèƒ½è¿”å› 405 Method Not Allowed é”™è¯¯ï¼Œä½†åˆ›å»ºåŠŸèƒ½æ­£å¸¸ã€‚

#### æ ¹æœ¬åŸå› 
Cloudflare çš„å®‰å…¨è§„åˆ™ä¼šæ‹¦æˆªå¸¦æ•°å­—è·¯å¾„å‚æ•°çš„ POST è¯·æ±‚ï¼ˆå¦‚ `POST /api/articles/1`ï¼‰ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢ CSRF æ”»å‡»ç­‰å®‰å…¨å¨èƒã€‚

#### è§£å†³æ–¹æ¡ˆ
é‡‡ç”¨æŸ¥è¯¢å‚æ•°æ›¿ä»£è·¯å¾„å‚æ•°çš„æ–¹å¼ï¼š

**ä¿®æ”¹å‰**ï¼š
- ç¼–è¾‘ï¼š`PUT /api/articles/1`
- åˆ é™¤ï¼š`DELETE /api/articles/1`
- é—®é¢˜ï¼šè¢« Cloudflare æ‹¦æˆªè¿”å› 405

**ä¿®æ”¹å**ï¼š
- ç¼–è¾‘ï¼š`POST /api/articles?id=1` + `X-HTTP-Method-Override: PUT`
- åˆ é™¤ï¼š`POST /api/articles?id=1` + `X-HTTP-Method-Override: DELETE`
- ç»“æœï¼šâœ… æˆåŠŸç»•è¿‡æ‹¦æˆª

### ğŸ“ æŠ€æœ¯å®ç°

#### å‰ç«¯ä¿®æ”¹ (`src/pages/ArticleManager.jsx`)
```javascript
// ç¼–è¾‘æ–‡ç« 
const url = editingArticle 
  ? `/api/articles?id=${editingArticle.id}`  // ä½¿ç”¨æŸ¥è¯¢å‚æ•°
  : '/api/articles'

const response = await fetch(url, {
  method: 'POST',  // ç»Ÿä¸€ä½¿ç”¨ POST
  headers: {
    'Content-Type': 'application/json',
    ...(editingArticle && { 'X-HTTP-Method-Override': 'PUT' })  // é€šè¿‡å¤´æŒ‡å®šå®é™…æ–¹æ³•
  },
  body: JSON.stringify(formData)
})

// åˆ é™¤æ–‡ç« 
const response = await fetch(`/api/articles?id=${article.id}`, {
  method: 'POST',
  headers: {
    'X-HTTP-Method-Override': 'DELETE'
  }
})
```

#### åç«¯ä¿®æ”¹ (`functions/api/articles.js`)
```javascript
// åŒæ—¶æ”¯æŒæŸ¥è¯¢å‚æ•°å’Œè·¯å¾„å‚æ•°ï¼Œä¼˜å…ˆä½¿ç”¨æŸ¥è¯¢å‚æ•°
const pathParts = url.pathname.split('/').filter(p => p)
const articleId = url.searchParams.get('id') || pathParts[2]

// æ”¯æŒ X-HTTP-Method-Override å¤´
const methodOverride = request.headers.get('X-HTTP-Method-Override')
if (method === 'POST' && methodOverride) {
  method = methodOverride.toUpperCase()
}

// POST è¯·æ±‚æ£€æŸ¥ï¼Œé˜²æ­¢è¯¯åŒ¹é…
case 'POST':
  if (articleId) {
    return errorResponse('POST è¯·æ±‚ä¸åº”åŒ…å«æ–‡ç«  IDï¼Œè¯·ä½¿ç”¨ PUT æ›´æ–°æ–‡ç« ', 400)
  }
  const createData = await request.json()
  return await createArticle(env, createData)
```

### âœ… éªŒè¯ç»“æœ

æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼š
- âœ… GET è¯·æ±‚æ­£å¸¸
- âœ… POST åˆ›å»ºæ–‡ç« æ­£å¸¸
- âœ… POST + Override: PUT ç¼–è¾‘æ–‡ç« æ­£å¸¸
- âœ… POST + Override: DELETE åˆ é™¤æ–‡ç« æ­£å¸¸

### ğŸ“š ç›¸å…³æ–‡æ¡£æ›´æ–°

- æ›´æ–° `README.md` å¸¸è§é—®é¢˜ç« èŠ‚ï¼Œæ·»åŠ  405 é”™è¯¯è§£å†³æ–¹æ¡ˆ
- åˆ›å»º `CHANGELOG.md` è®°å½•æ­¤æ¬¡é‡è¦å˜æ›´

### ğŸ¯ å½±å“èŒƒå›´

- **å‰ç«¯**ï¼š`src/pages/ArticleManager.jsx` - ä¿®æ”¹ç¼–è¾‘å’Œåˆ é™¤çš„è¯·æ±‚æ–¹å¼
- **åç«¯**ï¼š`functions/api/articles.js` - æ”¯æŒæŸ¥è¯¢å‚æ•°å’Œ Method Override
- **æ–‡æ¡£**ï¼š`README.md` - æ·»åŠ å¸¸è§é—®é¢˜è¯´æ˜

### ğŸ’¡ ç»éªŒæ€»ç»“

1. **Cloudflare å®‰å…¨è§„åˆ™**ï¼šæŸäº› HTTP è¯·æ±‚æ¨¡å¼ä¼šè¢« CDN/WAF æ‹¦æˆªï¼Œéœ€è¦é‡‡ç”¨å…¼å®¹æ€§æ›´å¥½çš„æ–¹æ¡ˆ
2. **Method Override æ¨¡å¼**ï¼šæ˜¯è§£å†³ HTTP æ–¹æ³•é™åˆ¶çš„æ ‡å‡†åšæ³•ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç§æ¡†æ¶
3. **æŸ¥è¯¢å‚æ•° vs è·¯å¾„å‚æ•°**ï¼šåœ¨æŸäº›åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢å‚æ•°æ¯”è·¯å¾„å‚æ•°æ›´å®‰å…¨ã€æ›´å…¼å®¹
4. **å‘åå…¼å®¹**ï¼šåç«¯åŒæ—¶æ”¯æŒä¸¤ç§æ–¹å¼ï¼Œç¡®ä¿å¹³æ»‘è¿‡æ¸¡

---

## ç‰ˆæœ¬è¯´æ˜

- æœ¬é¡¹ç›®é‡‡ç”¨æ—¥æœŸç‰ˆæœ¬å·æ ¼å¼ï¼š`YYYY-MM-DD`
- æ¯æ¬¡é‡è¦å˜æ›´éƒ½ä¼šè®°å½•åœ¨æ­¤æ–‡æ¡£ä¸­
- éµå¾ª [Keep a Changelog](https://keepachangelog.com/) è§„èŒƒ
